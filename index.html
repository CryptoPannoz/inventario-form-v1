<form id="inventoryForm">
  <label>Nome Appartamento</label>
  <input type="text" name="Nome Appartamento">

  <label>Data di Ispezione</label>
  <input type="date" name="Data di Ispezione">

  <label>Persona Responsabile</label>
  <input type="text" name="Persona Responsabile">

  <label>Indirizzo (Link Google Maps)</label>
  <input type="url" name="Indirizzo (Link google Maps)">

  <label>PROPRIETARIO</label>
  <input type="text" name="PROPRIETARIO">

  <label>Piano</label>
  <input type="text" name="Piano">

  <label>Nome sul Campanello</label>
  <input type="text" name="Nome sul Campanello">

  <button type="submit">Invia Inventario</button>
</form>

<script>
  document.getElementById('inventoryForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    const data = new URLSearchParams();
    for (const [key, value] of formData.entries()) {
      data.append(key, value);
    }

    fetch('https://script.google.com/macros/s/AKfycbw-FpYQl3fyBnN6KgcFj_lXfVlMqeYLPyHWP75HPpmw5rE3S_IT8hXUOnqdMgNkSfi0Cw/exec', {
      method: 'POST',
      body: data
    })
    .then(response => response.json())
    .then(resp => {
      console.log(resp);
      alert('Inventario inviato con successo!');
      this.reset();
    })
    .catch(error => {
      console.error(error);
      alert('Errore nell\'invio dell\'inventario.');
    });
  });
</script>
